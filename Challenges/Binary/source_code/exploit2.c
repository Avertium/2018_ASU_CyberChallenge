#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>
#include <err.h>

void win(){
  char ctext[] = "D0ww2mdPn7qwfq";
  char key[] = "\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03";
  char output[12];
  int i;

  for (i=0; i<strlen(ctext); i++){
    char temp = ctext[i] ^ key[i];
    output[i] = temp;
  }

  output[i] = '\0';
  
  printf("Flag: ");
  printf("%s\n", output);
}

int main(int argc, char **argv)
{
  volatile int modified;
  char buffer[128];

  if(argc == 1) {
      errx(1, "please specify an argument\n");
  }

  modified = 0;
  strcpy(buffer, argv[1]);

  if(modified == 0x71727374) {
      win();
  } else {
      printf("Try again, you got 0x%08x\n", modified);
  }
}
